<!DOCTYPE html>
<html lang="es-eu" dir="ltr">
    <head>
        <meta charset="utf-8">
        <title>U02_A02 - Isarel García Cabañeros</title>
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <link rel="stylesheet" type="text/css" href="../webroot/css/U02_A02.css">
    </head>
    <body class="container">
        <h1 id="indice" class="text-center">ÍNDICE - U02 - A02</h1>
        <section class="primeraSection">
            <p class="ejercicioEnunciado"><a href="#ejercicioEnunciado1">1.- Estructura de directorios y ficheros Apache2.<em></em></a></p>
            <p class="ejercicioEnunciado"><a href="#ejercicioEnunciado2">2.- Requerimientos del servidor.<em></em></a></p>
            <ul class="lista">
                <li class="elemento">
                    HTTP/1.1.
                </li>
                <li class="elemento">
                    SSL.
                </li>
                <li class="elemento">
                    Redireccinamiento.
                </li>
                <li class="elemento">
                    Acceso FTP a los archivos log de acceso, errores,...
                </li>
                <li class="elemento">
                    Soporte PHP.
                </li>
                <li class="elemento">
                    Bases de datos MySQL v14.14 distribución 5.7.25.
                </li>
                <li class="elemento">
                    Configuración de directorios mediante .htaccess.
                </li>
                <li class="elemento">
                    Configuracion mod_rewrite.
                </li>
            </ul>
            <p class="ejercicioEnunciado"><a href="#ejercicioEnunciado3">3.- Comando a2query.<em></em></a></p>
            <p class="ejercicioEnunciado"><a href="#ejercicioEnunciado4">4.- Directiva ErrorDocument.<em></em></a></p>
            <p class="ejercicioEnunciado"><a href="#ejercicioEnunciado5">5.- Directiva Alias.<em></em></a></p>
            <p class="ejercicioEnunciado"><a href="#ejercicioEnunciado6">6.- Directiva Redirect.<em></em></a></p>
            <p class="ejercicioEnunciado"><a href="#ejercicioEnunciado7">7.- Resolución de nombre /etc/hosts.<em></em></a></p>
            <p class="ejercicioEnunciado"><a href="#ejercicioEnunciado7">8.- Sitios virtuales basados en nombre.<em></em></a></p>
            <p class="ejercicioEnunciado"><a href="#ejercicioEnunciado7">9.- Autenticación BASIC.<em></em></a></p>
            <p class="ejercicioEnunciado"><a href="#ejercicioEnunciado7">10.- Autenticación DIGEST.<em></em></a></p>
        </section>
        <section class="segundaSection">
            <p class="ejercicio1" id="ejercicioEnunciado1">1.- Estructura de directorios y ficheros Apache2.</p>
            <ul class="lista">
                <li class="elemento">
                    La estructura general de apache2 es la siguiente.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image14.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">A continuación, se explicará brevemente para que sirve cada uno de estos archivos:
                    <ul class="lista">
                        <li class="elemento"></li>
                        <li class="elemento"></li>
                        <li class="elemento"></li>
                        <li class="elemento"></li>
                        <li class="elemento"></li>
                    </ul>
                </li>
            </ul>
            <p class="ejercicio2" id="ejercicioEnunciado2">2.- Requerimientos del servidor.</p>
            <ul class="lista">
                <li class="elemento">
                    HTTP/1.1.
                </li>
                <li class="elemento">
                    SSL.
                </li>
                <li class="elemento">
                    Redireccinamiento.
                </li>
                <li class="elemento">
                    Acceso FTP a los archivos log de acceso, errores,...
                    <ul class="lista">
                        <li class="elemento">
                            En el el siguiente fichero añadiremos dos nuevas líneas para poder ver el error.log y el access.log.
                        </li>
                    </ul>
                    <p style="color: red;">ATENCIÓN: Deberemos crear el directorio logs en /var/www/html, ambos archivos se crearán automáticamente en el direcorio que acabamos de crear.</p>
                    <img src="../webroot/images/U02_A02/image1.PNG" alt="image">
                    <ul class="lista">
                        <li class="elemento">
                            Quedará de la siguiente forma al añadir dichas lineas.
                        </li>
                    </ul>
                    <img src="../webroot/images/U02_A02/image2.PNG" alt="image">
                </li>
                <li class="elemento">
                    Soporte PHP.
                </li>
                <li class="elemento">
                    Bases de datos MySQL v14.14 distribución 5.7.25.
                </li>
                <li class="elemento">
                    Configuración de directorios mediante .htaccess.
                    <ul class="lista">
                        <li class="elemento">
                            Para que todos los sitios virtuales puedan leer el fichero de configuración de apache .htaccess, editar el archivo /etc/apache2/apache2.conf y buscar la parte de la siguiente imagen.
                        </li>
                    </ul>
                    <img src="../webroot/images/U02_A02/image3.PNG" alt="image">
                    <ul class="lista">
                        <li class="elemento">
                            Lo dejaremos de la siguiente forma.
                        </li>
                    </ul>
                    <img src="../webroot/images/U02_A02/image4.PNG" alt="image">
                    <p style="color: red">ATENCIÓN: Es importante reiniciar el servidor de apache después de estos pasos para que se produzcan los cambios, lo haremos con <b>sudo service apache2 restart</b>.</p>
                </li>
                <li class="elemento">
                    Configuracion mod_rewrite.
                </li>
            </ul>
            <p class="ejercicio3" id="ejercicioEnunciado3">3.- Comando a2query.</p>
            <ul class="lista">
                <li class="elemento"></li>
            </ul>

            <p class="ejercicio4" id="ejercicioEnunciado4">4.- Directiva ErrorDocument.</p>
            <ul class="lista">
                <li class="elemento">
                    Creamos el directorio page_error en la siguiente ruta.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image7.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Creamos el archivo html que queramos que se muestre cuando salte el error 404 dentro del directorio page_error.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image8.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Editamos el archivo html creado en el punto anterior.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image9.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Lo hacemos como html normal, en este caso solo haremos que nos muestre un h1.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image10.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Crearemos y modificaremos .htaccess en la siguiente ruta.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image11.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Escribiremos en .htaccess el siguiente contenido, en este caso controlaremos el error 404, pero podemos hacer con cualquier error cambiando el 404 por otro y la ruta del html que queramos mostrar.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image12.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Accedemos a nuestro servidor desde el navegador con un path que no exista, nos mostrará el archivo html creado anteriormente.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image13.PNG" alt="image">

            <p class="ejercicio5" id="ejercicioEnunciado5">5.- Directiva Alias.</p>
            <ul class="lista">
                <li class="elemento">
                    Vamos al archivo alias.conf en /etc/apache2/mods-available/alias.conf.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image15.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Lo editamos de la siguiente forma.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image16.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Creamos el directorio doc en /home/miadmin y ponemos a miadmin como propietario del directorio.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image17.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Podemos ver con el Alias no lleva al documento.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image18.PNG" alt="image">

            <p class="ejercicio6" id="ejercicioEnunciado6">6.- Directiva Redirect.</p>
            <ul class="lista">
                <li class="elemento">
                    En el archivo .htaccess añadimos la siguiente linea.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image19.PNG" alt="image">

            <p class="ejercicio7" id="ejercicioEnunciado7">7.- Resolución de nombre /etc/hosts.</p>
            <ul class="lista">
                <li class="elemento">
                    Modificaremos el archivo hosts que se encuentra en /etc de la siguiente forma.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image20.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Ahora en el anfitrión en C:/Windows/System32/drivers/etc modificamos el archivo hosts.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image21.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Comprobamos que funciona escribiendo uno de los 5 nombres que hemos introducido.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image22.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Para comprobar la caché en el anfitrión usamos el comando ipconfig /displaydns y para borrar la caché ipconfig /flushdns.
                </li>
            </ul>

            <p class="ejercicio8" id="ejercicioEnunciado8">8.- Sitios virtuales basados en nombre.</p>
            <ul class="lista">
                <li class="elemento">
                    Creamos los siguientes directorios.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image23.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Creamos los usuarios israel, daw1 y daw2.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image24.PNG" alt="image">
            <img src="../webroot/images/U02_A02/image25.PNG" alt="image">
            <img src="../webroot/images/U02_A02/image26.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Cambiamos los propietarios de los directorios.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image27.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Cambiamos los permisos de los directorios.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image28.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Subimos los index a los directorias public_html.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image29.PNG" alt="image">
            <img src="../webroot/images/U02_A02/image30.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Copiamos el archivo 000-default.conf con otro nombre.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image31.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Editamos la copia de la siguiente forma.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image32.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Checkeamos el fichero, activamos el sitio y reiniciamos el servicio.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image33.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Desactivamos el sitio 000-default.conf.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image34.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Copiaremos este fichero con los otros 2 sitios y los configuraremos como el de empresa1 pero con sus rutas.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image35.PNG" alt="image">

            <p class="ejercicio9" id="ejercicioEnunciado9">9.- Autenticación BASIC.</p>
            <ul class="lista">
                <li class="elemento">
                    Vamos a crear dos usuarios, profesor1 y profesor2
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image36.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Comprobamos el fichero .htpasswd para ver que están creados
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image37.PNG" alt="image">
            <img src="../webroot/images/U02_A02/image38.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Entramos con el usuario tunombre y creamos el directorio apuntes en public_html.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image39.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Comprobamos que el módulo auth-basic.load está activado.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image40.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Editamos el fichero tunombre.local.conf de la siguiente forma.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image41.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Reiniciamos el servicio apache e intentamos acceder al directorio apuntes, solo será accesible con profesor1 y profesor2.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image42.PNG" alt="image">
            <img src="../webroot/images/U02_A02/image43.PNG" alt="image">
            <img src="../webroot/images/U02_A02/image44.PNG" alt="image">
            <img src="../webroot/images/U02_A02/image45.PNG" alt="image">

            <p class="ejercicio10" id="ejercicioEnunciado10">10.- Autenticación DIGEST.</p>
            <ul class="lista">
                <li class="elemento">
                    Vamos a crear dos usuarios, alumno1 y alumno2.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image46.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Comprobamos el archivo .htdigest para ver que están creados.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image47.PNG" alt="image">
            <img src="../webroot/images/U02_A02/image48.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Entramos con el usuario tunombre y creamos un directorio usuarios en public_html.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image49.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Activamos el módulo auth_digest y reiniciamos el servicio
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image50.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Modificamos el fichero tunombre.local.conf de la siguiente forma.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image51.PNG" alt="image">
            <ul class="lista">
                <li class="elemento">
                    Reiniciamos el servicio y probamos.
                </li>
            </ul>
            <img src="../webroot/images/U02_A02/image52.PNG" alt="image">
            <img src="../webroot/images/U02_A02/image53.PNG" alt="image">
            <img src="../webroot/images/U02_A02/image54.PNG" alt="image">
            <img src="../webroot/images/U02_A02/image55.PNG" alt="image">
        </section>
    </body>
</html>
